mkfs.vfat -F 32 /dev/sda1 && mkfs.ext4 /dev/sda2 && mount /dev/sda2 /mnt/gentoo && mkfs.ext4 /dev/sda3 && mkdir /mnt/gentoo/home && mount /dev/sda3 /mnt/gentoo/home && cd /mnt/gentoo && wget -c ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo/releases/amd64/autobuilds/current-stage3-amd64/stage3-amd64-XXXXXX.tar.xz && tar xvpf stage3-*.tar.xz --xattrs-include='*.*' --numeric-owner && nano -w /mnt/gentoo/etc/portage/make.conf && mirrorselect -i -o >> /mnt/gentoo/etc/portage/make.conf && mkdir --parents /mnt/gentoo/etc/portage/repos.conf && cp /mnt/gentoo/usr/share/portage/config/repos.conf /mnt/gentoo/etc/portage/repos.conf/gentoo.conf && cat /mnt/gentoo/etc/portage/repos.conf/gentoo.conf && cp --dereference /etc/resolv.conf /mnt/gentoo/etc/ && mount -t proc /proc /mnt/gentoo/proc && mount --rbind /sys /mnt/gentoo/sys && mount --make-rslave /mnt/gentoo/sys && mount --rbind /dev /mnt/gentoo/dev && mount --make-rslave /mnt/gentoo/dev && chroot /mnt/gentoo /bin/bash && source /etc/profile && export PS1="(chroot) ${PS1}" && fallocate -l 2048M /swapfile && chmod 600 /swapfile && mkswap /swapfile && swapon /swapfile && mkdir /boot/efi && mount /dev/sda1 /boot/efi && time emerge --sync && eselect profile list
eselect profile set X && time emerge -qavuND @world && echo "Europe/Madrid" > /etc/timezone && emerge --config sys-libs/timezone-data && nano -w /etc/locale.gen && locale-gen && eselect locale list
eselect locale set X && env-update && source /etc/profile && export PS1="(chroot) $PS1" && time emerge -av sys-kernel/gentoo-sources && time emerge -av sys-kernel/genkernel && nano -w /etc/fstab && nano -w /etc/genkernel.conf && genkernel --no-zfs --no-btrfs --menuconfig all && time emerge -av sys-kernel/linux-firmware && time emerge -av net-wireless/broadcom-sta && time emerge -av x11-misc/sddm && ip link show
time emerge --ask --verbose --noreplace net-misc/netifrc && nano -w /etc/conf.d/net && cd /etc/init.d && ln -s net.lo net.wlp2s0 && rc-update add net.wlp2s0 default && passwd && nano -w /etc/conf.d/hostname && nano -w /etc/hosts && nano -w /etc/rc.conf && nano -w /etc/conf.d/keymaps && nano -w /etc/conf.d/hwclock && time emerge -av app-admin/sysklogd && rc-update add sysklogd default && time emerge -av sys-process/cronie && rc-update add cronie default && time emerge -av sys-apps/mlocate && time emerge -av net-misc/dhcpcd && time emerge -av net-wireless/iw net-wireless/wpa_supplicant && echo 'GRUB_PLATFORMS="efi-64"' >> /etc/portage/make.conf && time emerge -av sys-boot/grub:2 && grub-install --target=x86_64-efi --efi-directory=/boot --removable && grub-mkconfig -o /boot/grub/grub.cfg && time emerge -av app-shells/zsh app-shells/zsh-completions app-shells/gentoo-zsh-completions && chsh -s /bin/zsh && exit && cd && umount -l /mnt/gentoo/dev{/shm,/pts,} && umount -R /mnt/gentoo
reboot
